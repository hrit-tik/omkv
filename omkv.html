<!DOCTYPE html>
<html>
  <head>
    <title>Guide the Peacock!</title>
    <style>
      #map {
        height: 400px;
        width: 100%;
      }
      #info {
        margin: 10px;
        font-family: Arial, sans-serif;
      }
    </style>
  </head>
  <body>
    <h2>Guide the Peacock to the Nearest Field</h2>
    <div id="info">Finding your location...</div>
    <div id="map"></div>

    <!-- Load Google Maps JavaScript API with Directions API enabled -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwPCdYDrcmOeMs1CdMqz8YWYYlXi38rWc&callback=initMap" async defer></script>

    <script>
      function initMap() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function (position) {
            const userPos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            // Generate random nearby field location
            const fieldPos = {
              lat: userPos.lat + ((Math.random() - 0.5) / 500),
              lng: userPos.lng + ((Math.random() - 0.5) / 500)
            };

            // Initialize the map
            const map = new google.maps.Map(document.getElementById("map"), {
              zoom: 15,
              center: userPos
            });

            // Add Peacock marker
            new google.maps.Marker({
              position: userPos,
              map: map,
              label: "ðŸ¦š",
              title: "Your Peacock!"
            });

            // Add Field marker
            new google.maps.Marker({
              position: fieldPos,
              map: map,
              label: {
                text: "ðŸŒ¾",
                color: "green",
                fontSize: "20px"
              },
              title: "Nearest Field"
            });

            // Add a path between peacock and field
            const directionsService = new google.maps.DirectionsService();
            const directionsRenderer = new google.maps.DirectionsRenderer({
              map: map,
              suppressMarkers: true // because we already added our custom markers
            });

            directionsService.route(
              {
                origin: userPos,
                destination: fieldPos,
                travelMode: google.maps.TravelMode.WALKING
              },
              function (response, status) {
                if (status === google.maps.DirectionsStatus.OK) {
                  directionsRenderer.setDirections(response);
                  document.getElementById("info").textContent = "Path found! Follow the trail to the field!";
                } else {
                  document.getElementById("info").textContent = "Could not draw path: " + status;
                }
              }
            );
          }, function (error) {
            document.getElementById("info").textContent = "Error getting location: " + error.message;
          });
        } else {
          document.getElementById("info").textContent = "Geolocation not supported by your browser.";
        }
      }
    </script>
  </body>
</html>